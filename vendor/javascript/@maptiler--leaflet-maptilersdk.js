import*as t from"@maptiler/sdk";import i from"leaflet";let e=null,a=null,n=null,o=null,s=null,r=null;function g(){i.MaptilerLayer=i.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(t){i.setOptions(this,t),this._throttledUpdate=i.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(t){this._container||this._initContainer();const e=document.createElement("a");e.href="https://www.maptiler.com",e.style="position:absolute; left:10px; bottom:2px; z-index:999;";const a=document.createElement("img");a.src="https://api.maptiler.com/resources/logo.svg",a.alt="MapTiler logo",a.width="100",a.height="30",e.appendChild(a),t.getContainer().appendChild(e);const n=this.getPaneName();t.getPane(n).appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),t.options.zoomAnimation&&i.DomEvent.on(t._proxy,i.DomUtil.TRANSITION_END,this._transitionEnd,this),t.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(t){this._map._proxy&&this._map.options.zoomAnimation&&i.DomEvent.off(this._map._proxy,i.DomUtil.TRANSITION_END,this._transitionEnd,this);const e=this.getPaneName();t.getPane(e).removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const t=this.getSize().multiplyBy(.5),e=this._map.latLngToContainerPoint(this._map.getCenter());return i.latLngBounds(this._map.containerPointToLatLng(e.subtract(t)),this._map.containerPointToLatLng(e.add(t)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(t){this._maptilerMap.setStyle(t)},setLanguage:function(t){this._maptilerMap.setLanguage(t)},_roundPoint:function(t){return{x:Math.round(t.x),y:Math.round(t.y)}},_initContainer:function(){const t=this._container=i.DomUtil.create("div","leaflet-gl-layer"),e=this.getSize(),a=this._map.getSize().multiplyBy(this.options.padding);t.style.width=e.x+"px",t.style.height=e.y+"px";const n=this._map.containerPointToLayerPoint([0,0]).subtract(a);i.DomUtil.setPosition(t,this._roundPoint(n))},_initMaptilerSDK:function(){const e=this._map.getCenter();let a=this.options.style,n=this.options.apiKey;if((typeof this.options.style=="string"||this.options.style instanceof String)&&this.options.style.startsWith("https://api.maptiler.com/maps/"))try{const t=new URL(this.options.style),i=t.searchParams.get("key");i&&(n=i,t.searchParams.delete("key"),a=t.href)}catch(t){console.error(t)}const o={...this.options,style:a,apiKey:n,container:this._container,center:[e.lng,e.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(delete o.center,delete o.zoom),this._maptilerMap=new t.Map(o),this._maptilerMap.once("load",(()=>{this.fire("ready")})),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",(()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)})),this._maptilerMap.transform.latRange=null,this._maptilerMap.transform.maxValidLatitude=1/0,this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const s=this._maptilerMap._actualCanvas;i.DomUtil.addClass(s,"leaflet-image-layer"),i.DomUtil.addClass(s,"leaflet-zoom-animated"),this.options.interactive&&i.DomUtil.addClass(s,"leaflet-interactive"),this.options.className&&i.DomUtil.addClass(s,this.options.className),Object.keys(t.helpers).forEach((i=>{this[i]=e=>t.helpers[i].apply(null,[this._maptilerMap,e])}))},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const t=this.getSize(),e=this._map.getSize().multiplyBy(this.options.padding),a=this._map.containerPointToLayerPoint([0,0]).subtract(e);i.DomUtil.setPosition(this._container,this._roundPoint(a)),this._transformGL(),this._maptilerMap.transform.width!==t.x||this._maptilerMap.transform.height!==t.y?(this._container.style.width=t.x+"px",this._container.style.height=t.y+"px",this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){const i=this._map.getCenter(),e=this._maptilerMap.transform;e.center=t.LngLat.convert([i.lng,i.lat]),e.zoom=this._map.getZoom()-1},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(t){const e=this._map.getZoomScale(t.zoom),a=this._map.getSize().multiplyBy(this.options.padding*e),n=this.getSize()._divideBy(2),o=this._map.project(t.center,t.zoom)._subtract(n)._add(this._map._getMapPanePos().add(a))._round(),s=this._map.project(this._map.getBounds().getNorthWest(),t.zoom)._subtract(o);i.DomUtil.setTransform(this._maptilerMap._actualCanvas,s.subtract(this._offset),e)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const t=this._map.getZoomScale(this._map.getZoom());i.DomUtil.setTransform(this._maptilerMap._actualCanvas,null,t),this._zooming=!1,this._update()},_transitionEnd:function(){i.Util.requestAnimFrame((function(){const t=this._map.getZoom(),e=this._map.getCenter(),a=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());i.DomUtil.setTransform(this._maptilerMap._actualCanvas,a,1),this._maptilerMap.once("moveend",i.Util.bind((function(){this._zoomEnd()}),this)),this._maptilerMap.jumpTo({center:e,zoom:t-1})}),this)},_resize:function(t){this._transitionEnd(t)}}),e=i.MaptilerLayer,i.maptilerLayer=function(t){return new i.MaptilerLayer(t)},a=i.maptilerLayer,i.MaptilerStyle={},Object.keys(t.MapStyle).forEach((e=>{i.MaptilerStyle[e]=t.MapStyle[e]})),n=i.MaptilerStyle,o=i.MaptilerStyle,i.maptilerStyle=i.MaptilerStyle,i.MaptilerLanguage={},Object.keys(t.Language).forEach((e=>{i.MaptilerLanguage[e]=t.Language[e]})),s=i.MaptilerLanguage,r=i.MaptilerLanguage,i.maptilerLanguage=i.MaptilerLanguage}(()=>{try{g()}catch(t){console.error(t)}})();export{s as MaptilerLanguage,e as MaptilerLayer,n as MaptilerStyle,g as init,r as maptilerLanguage,a as maptilerLayer,o as maptilerStyle};

